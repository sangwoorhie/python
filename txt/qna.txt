<1.	검색결과 캐시>
-	비슷한 질문이면 캐시에서 가져오는지?
-	캐시관리가 어떻게 되는지?

현재는 정확히 동일한 질문만 캐시에서 가져오고, 의미적으로 비슷한 질문은 캐시를 활용하지 않는 상태.
100% 정확한 매칭만 가능:

"성경통독을하루에 최대 몇 장  할 수 있나요?" ← 공백 2개
"성경통독을하루에 최대 몇 장 할 수 있나요?" ← 공백 1개
결과: 서로 다른 캐시 키 → 별도 검색 수행

다층 캐시 구조
Level 1: 검색 결과 캐시 (최상위) - 24시간 TTL
├── 키: "search:해시값"
├── 저장: 최종 검색 결과 (점수 계산 완료된 상태)
└── 로그: "검색 결과 캐시 저장: ... (3개 결과)"

Level 2: 임베딩 벡터 캐시 - 영구 보관
├── 키: 질문 텍스트 자체
├── 저장: 1536차원 벡터 데이터  
└── 로그: "임베딩 캐시 저장: ... (1536차원)"

Level 3: 의도 관련성 계산 캐시 - 메모리 (1000개 제한)
├── 키: "의도:참조질문" 조합
├── 저장: 의도 유사성 점수
└── 용도: 동일한 참조답변 재분석 방지

Level 4: API 응답 캐시 (Redis) - GPT 호출 결과
├── 키: 요청 해시
├── 저장: GPT 원본 응답
└── 용도: 동일한 API 호출 방지

3. 현재 로그의 캐시 동작
# 1단계: 검색 결과 캐시 확인
캐시 조회 시작: 검색 결과, 키=search:61099d1bcf3a8b40
검색 결과 캐시 전체 미스 - 새 검색 필요  ← 이전에 없던 질문

# 2단계: 임베딩 생성 및 캐시 저장  
임베딩 캐시 저장: 성경 통독을 하루에... (1536차원)  ← 새로 생성
임베딩 캐시 저장: 사용자가 하루에 성경... (1536차원)  ← 새로 생성  
임베딩 캐시 저장: 성경 성경 통독 하루... (1536차원)  ← 새로 생성

# 3단계: 검색 완료 후 결과 캐시 저장
검색 결과 캐시 저장: 성경 통독을 하루에... (3개 결과)  ← 다음에 재사용



<2.	의도 관련성 / 개념 관련성은 어떻게 계산되는지?>

final_score = (벡터 유사도 * 0.6) + (의도 관련성 * 0.25) + (개념 관련성 * 0.15)

- 벡터 유사도 (60%): 텍스트를 숫자 벡터로 변환한 후, 코사인 유사도 같은 수학적 방법으로 계산되는 기본 텍스트 유사도. (이 부분은 질문의 초점이 아니니 간단히 넘기고, 나머지 두 가지에 집중하겠습니다.)
- 의도 관련성 (25%): 사용자가 정말로 묻고 싶은 "의도"가 기존 답변과 얼마나 맞는지 측정.
- 개념 관련성 (15%): 질문에 포함된 핵심 개념(키워드나 아이디어)이 기존 답변과 얼마나 겹치는지 측정.

(예시) 사용자 질문: "요한복음 3장 16절 NIV하고 KJV 같이 보려면 어떻게 해야 하나요?"

기존 데이터베이스 답변들:
답변 A: "두 개의 번역본을 동시에 보는 방법은 화면 분할 기능을 사용하세요"
답변 B: "요한복음은 신약성경의 네 번째 책입니다"
답변 C: "NIV 번역본 설정 방법은 설정 메뉴에서 변경할 수 있습니다"

1. 의도 관련성


2. 개념 관련성


<3.	5개 레이어를 구성한 이유와, 어떻게 사용되는지?>
다층 검색 시스템은 하나의 질문에 대해 다각도로 접근하여 놓칠 수 있는 관련 답변들을 최대한 찾아내는 전략입니다. 
각 레이어는 "서로 다른 방식"으로 의미적 유사성을 탐지하므로, 전체적으로 검색 품질과 커버리지를 크게 향상시킴.
동적 레이어 결정 로직으로 레이어 별 가중치를 달리 주며, 조건에 따라 모든 레이어가 활성화되지 않을 수 있습니다.

Layer 1: 원본 질문 (Original Query)
목적 : 사용자가 입력한 정확한 표현과 일치하는 답변 찾기

Layer 2: 표준화된 의도 기반 질문 (Intent-based Query)
목적 :  GPT가 분석한 표준화된 형태로 검색하여 의미적으로 동일한 다른 표현 매칭

Layer 3: 핵심 의도만 (Core Intent)
목적 : 질문의 본질적 의도를 추상화하여 더 넓은 범위의 관련 답변 찾기

Layer 4: 의미론적 키워드 조합 (Semantic Keywords)
목적 : GPT가 추출한 핵심 키워드로 검색하여 키워드 중심 매칭

Layer 5: 개념 기반 검색 (Concept-based)
목적 : 규칙 기반으로 추출한 개념들로 보완 검색 수행


<4.	의도 분석을 어떻게 하는지? 구성과 예시>



<5.	점수를 매긴 다음 어떻게 유사답변을 가져오는지?>



<6.	실행되는 전체 로그>

